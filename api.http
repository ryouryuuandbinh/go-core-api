### ============================================================================
### CẤU HÌNH BIẾN MÔI TRƯỜNG (VARIABLES)
### ============================================================================
@baseUrl = http://localhost:8080/api/v1
@email = admin@example.com
@password = NewStrongPass999!

# --- COPY TOKEN TỪ API LOGIN VÀ DÁN VÀO ĐÂY ĐỂ DÙNG CHO CÁC API DƯỚI ---
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NzE4NDUzODAsInJvbGUiOiJhZG1pbiIsInRva2VuX3R5cGUiOiJhY2Nlc3MiLCJ0b2tlbl92ZXJzaW9uIjozLCJ1c2VyX2lkIjoxNH0.fvg5iYQ9rFwAMCtDX7BmY-sHn19j_RxIEUZ17fWypKk
@refreshToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NzI0NDg4MDQsInRva2VuX3R5cGUiOiJyZWZyZXNoIiwidXNlcl9pZCI6MTR9.dlnRI2V8nGJ_VeD1qrn4LltL2Fxd0tNH7m5TqRjdLl4


### ============================================================================
### 1. NHÓM API AUTHENTICATION (KHÔNG CẦN TOKEN)
### ============================================================================

### 1.1 Đăng ký tài khoản mới
# Mật khẩu yêu cầu tối thiểu 8 ký tự (theo auth_handler.go)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
    "email": "{{email}}",
    "password": "{{password}}"
}

###

### 1.2 Đăng nhập
# Thành công sẽ trả về access_token và refresh_token. Hãy copy access_token dán lên biến ở đầu file.
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
    "email": "{{email}}",
    "password": "{{password}}"
}

###

### 1.3 Cấp lại Token mới (Refresh Token)
POST {{baseUrl}}/auth/refresh-token
Content-Type: application/json

{
    "refresh_token": "{{refreshToken}}"
}


### ============================================================================
### 2. NHÓM API USER PROFILE (CẦN ACCESS TOKEN)
### ============================================================================

### 2.1 Lấy thông tin cá nhân của tôi (Get Me)
GET {{baseUrl}}/users/me
Authorization: Bearer {{accessToken}}

###

### 2.2 Cập nhật hồ sơ cá nhân
PUT {{baseUrl}}/users/me
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
    "full_name": "Nguyễn Văn Test",
    "phone": "0987654321",
    "avatar": "uploads/2026/02/23/default.jpg"
}

###

### 2.3 Đổi mật khẩu
PUT {{baseUrl}}/users/me/password
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
    "old_password": "{{password}}",
    "new_password": "NewStrongPass999!"
}

###

### 2.4 Đăng xuất (Thu hồi Token)
# Sau khi chạy API này, accessToken hiện tại sẽ bị vô hiệu hoá
POST {{baseUrl}}/auth/logout
Authorization: Bearer {{accessToken}}


### ============================================================================
### 3. NHÓM API QUẢN TRỊ ADMIN (CẦN TOKEN VÀ QUYỀN ADMIN)
### Lưu ý: Bạn cần vào Database đổi cột 'role' của user thành 'admin' để test nhóm này
### ============================================================================

### 3.1 Xem Dashboard Admin
GET {{baseUrl}}/admin/dashboard
Authorization: Bearer {{accessToken}}

###

### 3.2 Lấy danh sách Users (Có phân trang & tìm kiếm)
GET {{baseUrl}}/users?page=1&limit=5&sort=created_at desc&keyword=admin
Authorization: Bearer {{accessToken}}

###

### 3.3 Xem chi tiết 1 User bằng ID
# Đổi số 1 thành ID thực tế trong DB
GET {{baseUrl}}/users/14
Authorization: Bearer {{accessToken}}

###

### 3.4 Cấp/Đổi quyền User (Phân quyền)
PUT {{baseUrl}}/users/15
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
    "role": "admin"
}

###

### 3.5 Xoá mềm User (Soft Delete)
DELETE {{baseUrl}}/users/15
Authorization: Bearer {{accessToken}}

###

### 3.6 Dọn dẹp User vĩnh viễn (Purge/Hard Delete)
DELETE {{baseUrl}}/users/15/purge
Authorization: Bearer {{accessToken}}


### ============================================================================
### 4. UPLOAD MEDIA
### ============================================================================

### 4.1 Upload Hình Ảnh
# Chú ý: REST Client hỗ trợ upload file cục bộ bằng cú pháp <
POST {{baseUrl}}/upload/image
Authorization: Bearer {{accessToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="test_image.jpg"
Content-Type: image/jpeg

< ./test_image.png
------WebKitFormBoundary7MA4YWxkTrZu0gW--